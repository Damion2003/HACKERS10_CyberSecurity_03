### Analysis of Zeus Banking Trojan Report


```
File Name : invoice_2318362983713_823931342io.pdf.exe
```


**Hashes**
md5:  `EA039A854D20D7734C5ADD48F1A51C34` 
sha1: `9615DCA4C0E46B8A39DE5428AF7DB060399230B2`
sha256: `69E966E730557FDE8FD84317CDEF1ECE00A8BB3470C0B58F3231E170168AF169`



*file > first 32 bytes (text),MZ............................................@..............*
*All executable files have MZ in first bytes of hex*




##### Fingerprint

VirusTotal Output

![[Pasted image 20250411150607.png]]
64/72 Vendors flagged has malicous




#### Strings

Tools used : PeStudio, Floss.exe, & Capa

corect.com


![[Pasted image 20250414162629.png]]

**Corect.com yielded no interesting results.**


`AsksmaceaglyBubuPulsKaifTeasMistPeelGhisPrimChaoLyreroeno` 
`KERNEL32.MulDiv` 
`BagsSpicDollBikeAzonPoopHamsPyasmap` 
`KERNEL32.SetCurrentDirectoryA` 
`BardHolyawe` 
`SHLWAPI.SHFreeShared` 
`BathEftsDawnvilepughThroCymakohloverMitefuzerat` 
`SHLWAPI.PathMakeSystemFolderW` 
`BemaCadsPodsWavyCedeRadsbrioOustPerefenom` 
`USER32.SetDlgItemTextW` 
`BullbonyaweeWaitsnugTierDriblibye` 
`KERNEL32.VirtualQuery CameValeWauler` 
`USER32.IsIconic` 
`CedeSalsshulLimyThroliraValeDonabox` 
`USER32.CreateCaret` 
`CellrotoCrudUntohighCols` 
`KERNEL32.CreateFileA` 
`DenyLubeDunssawsOresvarut` 
`SHLWAPI.PathRemoveFileSpecA` 
`DragRoutflusCrowPeatmownNewsyaksSerfmare` 
`USER32.DestroyIcon` 
`Dumpcotsavo` 
`USER32.SetDlgItemInt` 
`DungBadebankBangGelthoboCocaBozotsksWheyVaryShoghoseNipsCadisi` 
`USER32.EndPaint ExitRollWoodGumsgamaSloerevsWussletssinkYearZitiryesHypout USER32.GetClassInfoW` 
`FociTalcileador` 
`KERNEL32.ConvertDefaultLocale` 
`GeneAilshe KERNEL32.FindFirstFileA` 
`GhisGoodHowlCoonCigscateged` 
`KERNEL32.GetWindowsDirectoryA` 
`GimpWadsdashHoraYardSeatDeanScanscowRantKeasfib` 
`KERNEL32.LCMapStringW` 
`Haesourfe`
`USER32.GetKeyNameTextA` 
`HoggSoonLasstwaeNapeCeilBawlscopdub` 
`KERNEL32.SystemTimeToFileTime` 
`Icontellnoway` 
`SHLWAPI.PathRemoveBlanksW` 
`ImidslatJokyCombdrubChefBilkSale` 
`USER32.GetShellWindow`
`IzararfsFlamWostAirsconsMouefemelallPoretweeSacsOxidMinx` 
`SHLWAPI.PathAddExtensionA` 
`JabsNaveFateLariManyLeeksecshiesBawlwoo` 
`KERNEL32.CreateIoCompletionPort`
`KatsDoreOmerBetsKoraKeef` 
`KERNEL32.GetShortPathNameA` 
`KineChamLows KERNEL32.SetCurrentDirectoryW` 
`LeerMiff KERNEL32.LeaveCriticalSection` 
`MaarSectFiscNextMattbamsErasnimstoeaBadshon`
`USER32.GetClassInfoW`
`MarkMokeOsesShwaSkegpornlimemim`
`KERNEL32.GetStartupInfoW`
`MeanOrrabirogirtWorkGawpSassPirnVinoLotaPledEidefe`
`SHLWAPI.SHLockShared`
`NextLoveOralwanySurfhm`
`KERNEL32.VerSetConditionMask`
`NisiBoyolineJiaoveryObiaowedblamHaetMaulweensky`
`SHLWAPI.PathCanonicalizeW`
`OastcabskamiKartDumbInksSomsMass`
`KERNEL32.SetCurrentDirectoryA`
`PeckQuinFillrillsaw`
`KERNEL32.GetThreadPriority`
`RamilimaputtHastJobs`
`KERNEL32.FindNextFileW`
`RemsSlaySoreAnoaaxalbuffusesemeuMapsyogaHangLoud`
`SHLWAPI.PathMakePrettyA`
`RidsFineZingMickMomsdue`
`USER32.GetMonitorInfoW`
`SeminerdsoloseenYaginobox`
`SHLWAPI.PathIsLFNFileSpecA`
`SiretomsbritGrewIckyNapaLumsBoaren`
`KERNEL32.OpenFileMappingA`
`SlabKitsSlayseptPfftjiffSabsdeskOafsNowtMemsKirnKepiMiffDunt`
`KERNEL32.OpenSemaphoreW`
`SoldKartAgueiliaRushWauldhal`
`SHLWAPI.PathIsUNCW`
`SuitplieGunsMaidBaitFeusJiaotodycolyAlbsLuneToyspe`
`USER32.GetPropW`
`SungActaKopsMaarposyparefuzedeck`
`SHLWAPI.PathIsDirectoryA`
`ToeaTailecusGeesSoliCadeSpueEndsPlaykaphall`
`SHLWAPI.PathRemoveArgsW`
`Vavsrubepodsjadebrooli`
`USER32.GetUpdateRgn`
`VeerCrawFlateel`
`SHLWAPI.PathParseIconLocationA`
`WainMeekPinyWonkpooflaudsir`
`KERNEL32.GetWindowsDirectoryW`
`WhopTestrangrapsdebsTzarNipaYins`
`KERNEL32.DeleteFileA`
`YeukMags`
`KERNEL32.GlobalHandle`
`ZetaBeduPirnhipsjailTingSrisTeleAposhuskNameHoerflagemuwo`
`USER32.LoadIconA`

-------------------------------------------------------------------
##### API CALLS
ascii,24,0x0001EAC2,x,AllowSetForegroundWindow
ascii,18,0x0001EBDC,x,DdeQueryNextServer
ascii,20,0x0001EB8E,x,EnumClipboardFormats
ascii,12,0x0001E9FC,x,FindNextFile
ascii,16,0x0001EB4C,x,GetAsyncKeyState
ascii,16,0x0001EB18,x,GetClipboardData
ascii,17,0x0001EA72,x,GetClipboardOwner
ascii,25,0x0001E94A,x,GetConsoleAliasExesLength
ascii,16,0x0001E8E6,x,GetCurrentThread
ascii,22,0x0001E832,x,GetEnvironmentVariable
ascii,22,0x0001E982,x,GetEnvironmentVariable
ascii,13,0x0001E878,x,GlobalAddAtom
ascii,19,0x0001E71E,x,PathRenameExtension
ascii,14,0x0001E90A,x,VirtualQueryEx
ascii,9,0x0001EA64,x,VkKeyScan
ascii,7,0x0001EA40,x,WinExec
ascii,9,0x0001E91C,x,WriteFile
ascii,12,0x0001EAB2,-,UpdateWindow

##### Basic Static Analysis

Virtual Size and Raw Data


![[Pasted image 20250414162848.png]]
To  check if its packed or not (Likely not packed)





*DLL - Dynamic Library Link*
*dll is baically is a means of sharing code*
*also import many functionalities* 

----------------------------------------------------
**Libraries :** 

`SHLWAPI.dll,-,Implicit,21,Shell Light-weight Utility Library`
`KERNEL32.dll,-,Implicit,29,Windows NT BASE API Client`
`USER32.dll,-,Implicit,27,Multi-User Windows USER API Client Library`

-------------------------------------------
**Basic Capa Output**

![[Pasted image 20250415150046.png]]

This is using Defense Evasion Techniques to avoid inspection

--------------------------
##### Advanced Static Analysis


**Cutter Screenshots of assembly**

![[Pasted image 20250417143243.png]]


**CellrotoCrudUntohighCols**
![[Pasted image 20250417143813.png]]

ebx is kernel32 create file

-------------------------------------
##### Basic Dynamic Analysis

**Tools Used : Procmon, InetSim & Wireshark**

Found invoice process and child processess
![[Pasted image 20250417145016.png]]

![[Pasted image 20250417145147.png]]

-------------------------------------------------------

The Malware is also using Google updater as a way for ***persistence*** by executing every time google updates

![[Pasted image 20250417150511.png]]


Again Initiated the malware to check packets and found a domain  ---> lead to a dead end
![[Pasted image 20250417152107.png]]

-----------------------------
Through Procmon we found that has manipulated SetRegKeys and found a dll 
msimg32.dll
![[Pasted image 20250417163448.png]]  


##### YARA (IOC)
`rule Zeus {`
	`meta:`
		
	  `author ="Blip"`
	  `description="A detection rule agains ZeusBankingVersion_26Nov2013"`
	  
	
	`strings:`
	
	  `$file_name="invoice_2318362983713_823931342io.pdf.exe" ascii`
	  
	  `// Suspected name of functions and DLL fucntionalities`
	  
	  `$function_name_KERNEL32_CreateFileA="CellrotoCrudUntohighCols" ascii`
	  
	  `//PE Magic Byte.`
	  
	  `$PE_magic_byte="MZ"`
	
	  `// Hex String Function name`
	  
	  `$hex_string = {43 61 6D 65 56 61 6C 65 57 61 75 6C 65 72}`
	  
	`condition:`
	
	`$PE_magic_byte at 0 and $file_name`
	`and $function_name_KERNEL32_CreateFileA`
	`or $hex_string`
`}`

![[Pasted image 20250417171814.png]]
- -s Print matched strings
- -w Ignore warnings
- -p 32 Allocate  32 threads



